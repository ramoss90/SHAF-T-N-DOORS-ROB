--[[
    Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø´Ø§ÙØ·ÙŠÙ† v2.1
    Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ù…Ø¹ Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø¨ÙˆØ§Ø¨
    Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© + Ù…ØªØ¹Ù‚Ø¨ Ø§Ù„Ø£Ø¨ÙˆØ§Ø¨
--]]

local Players = game:GetService("Players")
local Lighting = game:GetService("Lighting")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local Player = Players.LocalPlayer
local Camera = workspace.CurrentCamera

-- Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
local ScreenGui = Instance.new("ScreenGui")
local ToggleButton = Instance.new("ImageButton")
local MainFrame = Instance.new("Frame")
local UICorner = Instance.new("UICorner")
local CloseButton = Instance.new("TextButton")
local UIStroke = Instance.new("UIStroke")
local TitleLabel = Instance.new("TextLabel")
local DoorCounterLabel = Instance.new("TextLabel") -- Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø¨ÙˆØ§Ø¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯

ScreenGui.Name = "AlShaftenScript"
ScreenGui.Parent = game.CoreGui
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Ø²Ø± Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ (Ù…Ø²ÙŠÙ† Ø¨Ø¥ÙŠÙ…ÙˆØ¬ÙŠ ğŸ’)
ToggleButton.Name = "ToggleButton"
ToggleButton.Parent = ScreenGui
ToggleButton.Size = UDim2.new(0, 50, 0, 50)
ToggleButton.Position = UDim2.new(0, 20, 0, 100)
ToggleButton.Image = "rbxassetid://6525356216"
ToggleButton.BackgroundTransparency = 1
ToggleButton.Draggable = true
ToggleButton.Active = true

-- Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (ØªØµÙ…ÙŠÙ… Ø­Ø¯ÙŠØ«)
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
MainFrame.Position = UDim2.new(0.3, 0, 0.2, 0)
MainFrame.Size = UDim2.new(0, 350, 0, 380) -- Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ Ù„Ø¹Ø±Ø¶ Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø¨ÙˆØ§Ø¨
MainFrame.Visible = false
MainFrame.Active = true
MainFrame.Draggable = true

UICorner.Parent = MainFrame
UICorner.CornerRadius = UDim.new(0, 12)
UIStroke.Parent = MainFrame
UIStroke.Thickness = 2
UIStroke.Color = Color3.fromRGB(0, 255, 127)
UIStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

-- Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø³ÙƒØ±Ø¨Øª (Ù…Ø²ÙŠÙ†)
TitleLabel.Parent = MainFrame
TitleLabel.Text = "âœ¨ Ø§Ù„Ø´Ø§ÙØ·ÙŠÙ† v2.1 | Doors âœ¨"
TitleLabel.Size = UDim2.new(0, 280, 0, 40)
TitleLabel.Position = UDim2.new(0.5, -140, 0, 10)
TitleLabel.BackgroundTransparency = 1
TitleLabel.TextColor3 = Color3.fromRGB(0, 255, 255)
TitleLabel.Font = Enum.Font.FredokaOne
TitleLabel.TextSize = 22
TitleLabel.TextStrokeTransparency = 0.7
TitleLabel.TextStrokeColor3 = Color3.fromRGB(0, 100, 100)

-- Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø¨ÙˆØ§Ø¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯
DoorCounterLabel.Name = "DoorCounter"
DoorCounterLabel.Parent = MainFrame
DoorCounterLabel.Text = "Ø§Ù†Øª Ø­Ø§Ù„ÙŠØ§ ÙÙŠ Ø§Ù„Ø¨Ø§Ø¨: 0"
DoorCounterLabel.Size = UDim2.new(0, 280, 0, 30)
DoorCounterLabel.Position = UDim2.new(0.5, -140, 0, 50)
DoorCounterLabel.BackgroundTransparency = 1
DoorCounterLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
DoorCounterLabel.Font = Enum.Font.GothamBold
DoorCounterLabel.TextSize = 16
DoorCounterLabel.TextStrokeTransparency = 0.7
DoorCounterLabel.TextStrokeColor3 = Color3.fromRGB(100, 100, 0)

-- Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ (Ù…Ø²ÙŠÙ†)
CloseButton.Parent = MainFrame
CloseButton.Text = "âŒ"
CloseButton.Size = UDim2.new(0, 35, 0, 35)
CloseButton.Position = UDim2.new(1, -40, 0, 5)
CloseButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.TextSize = 18
CloseButton.AutoButtonColor = false

-- ØªØ£Ø«ÙŠØ±Ø§Øª Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
CloseButton.MouseEnter:Connect(function()
    CloseButton.BackgroundColor3 = Color3.fromRGB(220, 20, 20)
end)
CloseButton.MouseLeave:Connect(function()
    CloseButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
end)

-- ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ ÙˆØ§Ù„Ø¥ØºÙ„Ø§Ù‚
ToggleButton.MouseButton1Click:Connect(function()
    MainFrame.Visible = not MainFrame.Visible
end)
CloseButton.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)

-- Ø¯Ø§Ù„Ø© Ø¥Ø¶Ø§ÙØ© Ø²Ø± (Ù…Ø²ÙŠÙ†Ø© Ø¨Ø¥ÙŠÙ…ÙˆØ¬ÙŠØ§Øª)
local function addToggle(name, emoji, callback, defaultState)
    local button = Instance.new("TextButton")
    button.Parent = MainFrame
    button.Size = UDim2.new(0, 280, 0, 35)
    button.Position = UDim2.new(0.5, -140, 0, (#MainFrame:GetChildren() - 5) * 40 + 90) -- ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù„ÙŠØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯
    button.Text = emoji .. " " .. name .. (defaultState and " [ğŸŸ¢]" or " [ğŸ”´]")
    button.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.Font = Enum.Font.GothamBold
    button.TextSize = 16
    button.AutoButtonColor = false
    
    -- ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø£Ø²Ø±Ø§Ø±
    button.MouseEnter:Connect(function()
        button.BackgroundColor3 = Color3.fromRGB(60, 60, 70)
    end)
    button.MouseLeave:Connect(function()
        button.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
    end)
    
    local state = defaultState or false
    button.MouseButton1Click:Connect(function()
        state = not state
        callback(state)
        button.Text = emoji .. " " .. name .. (state and " [ğŸŸ¢]" or " [ğŸ”´]")
    end)
end

-- ======== Ù†Ø¸Ø§Ù… Ù…ØªØ¹Ù‚Ø¨ Ø§Ù„Ø£Ø¨ÙˆØ§Ø¨ ========
local function setupDoorTracker()
    local currentDoor = 0
    local doorParts = {}
    
    -- Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¨ÙˆØ§Ø¨ ÙÙŠ Ø§Ù„Ù…Ø§Ø¨
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj.Name == "Door" and obj:IsA("Model") then
            table.insert(doorParts, obj)
        end
    end
    
    -- ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯ ÙƒÙ„ Ø¥Ø·Ø§Ø±
    RunService.Heartbeat:Connect(function()
        local char = Player.Character
        if not char or not char:FindFirstChild("HumanoidRootPart") then return end
        
        local hrp = char.HumanoidRootPart
        local closestDoor, closestDist = nil, math.huge
        
        for _, door in pairs(doorParts) do
            local doorPrimary = door.PrimaryPart or door:FindFirstChildWhichIsA("BasePart")
            if doorPrimary then
                local dist = (doorPrimary.Position - hrp.Position).Magnitude
                if dist < closestDist then
                    closestDist = dist
                    closestDoor = door
                end
            end
        end
        
        if closestDoor then
            local doorNumber = tonumber(closestDoor.Name:match("%d+")) or 0
            if doorNumber ~= currentDoor then
                currentDoor = doorNumber
                DoorCounterLabel.Text = "Ø§Ù†Øª Ø­Ø§Ù„ÙŠØ§ ÙÙŠ Ø§Ù„Ø¨Ø§Ø¨: " .. currentDoor
                
                -- Ø¥Ø´Ø¹Ø§Ø± Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø¨Ø§Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
                game:GetService("StarterGui"):SetCore("SendNotification", {
                    Title = "Ø§Ù„Ø¨Ø§Ø¨ " .. currentDoor,
                    Text = "Ù„Ù‚Ø¯ Ø¯Ø®Ù„Øª Ø§Ù„Ø¨Ø§Ø¨ " .. currentDoor,
                    Duration = 3,
                    Icon = "rbxassetid://6722534400"
                })
            end
        end
    end)
end

-- ØªÙ‡ÙŠØ¦Ø© Ù…ØªØ¹Ù‚Ø¨ Ø§Ù„Ø£Ø¨ÙˆØ§Ø¨
task.spawn(setupDoorTracker)

-- ... Ø¨Ù‚ÙŠØ© Ø§Ù„Ø³ÙƒØ±Ø¨Øª ÙƒÙ…Ø§ Ù‡Ùˆ Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±Ø§Øª ...
-- (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ Ù…Ù† Ø²Ø± Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø­ØªÙ‰ Ø§Ù„Ù†Ù‡Ø§ÙŠØ©)

-- ======== Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„ØµØ§Ù„Ø­Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ========
local validCodes = {
    ["Ù…Ø­Ù…Ø¯ ÙÙŠÙ…Ø¨ÙˆÙŠ"] = true,
    ["ÙŠÙˆØ³Ù Ø§Ø¨Ùˆ Ø±Ø§Ø³"] = true,
    ["Ø¹Ø¨Ø¯Ø§Ù„Ø§Ù„Ù‡ Ø¹Ù…ÙƒÙ…"] = true
}

-- Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£ÙƒÙˆØ§Ø¯
addToggle("ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯", "ğŸ”‘", function(state)
    if state then
        local input = game:GetService("Players").LocalPlayer:GetMouse()
        local code = input:GetPropertyChangedSignal("Target"):Wait()
        
        for codeName, _ in pairs(validCodes) do
            if code == codeName then
                game:GetService("StarterGui"):SetCore("SendNotification", {
                    Title = "ØªÙ… Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!",
                    Text = "Ø§Ù„ÙƒÙˆØ¯ " .. codeName .. " Ù…ÙØ¹Ù„",
                    Duration = 5,
                    Icon = "rbxassetid://6722534400"
                })
                return
            end
        end
        
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯",
            Text = "Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ§Ù„Ø­",
            Duration = 5,
            Icon = "rbxassetid://6722534400"
        })
    end
end, false)

-- ======== Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ========

-- ÙƒØ§Ø´Ù Ø§Ù„Ø¹Ù†Ø§ØµØ± (Ù…Ø²ÙŠÙ†)
addToggle("ÙƒØ§Ø´Ù Ø§Ù„Ø¹Ù†Ø§ØµØ±", "ğŸ”", function(state)
    local highlights = {
        KeyObtain = Color3.fromRGB(255, 255, 0),
        Lighter = Color3.fromRGB(255, 100, 0),
        Flashlight = Color3.fromRGB(100, 100, 255)
    }

    local connection
    local highlightedItems = {}

    local function cleanHighlights()
        for _, v in pairs(highlightedItems) do
            if v and v:FindFirstChild("Highlight") then
                v.Highlight:Destroy()
            end
        end
        highlightedItems = {}
    end

    if state then
        connection = RunService.RenderStepped:Connect(function()
            for _, obj in pairs(workspace:GetDescendants()) do
                if obj:IsA("Model") and not obj:FindFirstChild("Highlight") then
                    if highlights[obj.Name] then
                        local part = obj:FindFirstChildWhichIsA("BasePart")
                        if part and (part.Position - Camera.CFrame.Position).Magnitude < 50 then
                            local h = Instance.new("Highlight", obj)
                            h.FillColor = highlights[obj.Name]
                            h.OutlineColor = Color3.new(1, 1, 1)
                            h.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
                            table.insert(highlightedItems, obj)
                        end
                    end
                end
            end
        end)
    else
        if connection then connection:Disconnect() end
        cleanHighlights()
    end
end, false)

-- Ø¥Ø¶Ø§Ø¡Ø© ÙƒØ§Ù…Ù„Ø© (Ù…Ø²ÙŠÙ†Ø©)
addToggle("Ø¥Ø¶Ø§Ø¡Ø© ÙƒØ§Ù…Ù„Ø©", "ğŸ’¡", function(state)
    if state then
        Lighting.Ambient = Color3.new(1, 1, 1)
        Lighting.Brightness = 2
        Lighting.GlobalShadows = false
        Lighting.ClockTime = 12
        Lighting.OutdoorAmbient = Color3.new(1, 1, 1)
    else
        Lighting.Ambient = Color3.new(0.5, 0.5, 0.5)
        Lighting.Brightness = 1
        Lighting.GlobalShadows = true
        Lighting.OutdoorAmbient = Color3.new(0.5, 0.5, 0.5)
    end
end, false)

-- Ø³Ø±Ø¹Ø© Ø§Ù„Ù…Ø´ÙŠ (Ù…Ø²ÙŠÙ†Ø©)
addToggle("Ù…Ø´Ø±ÙˆØ¨ Ø§Ù„Ø³Ø±Ø¹Ø©", "âš¡", function(state)
    local h = Player.Character and Player.Character:FindFirstChildOfClass("Humanoid")
    if h then
        h.WalkSpeed = state and 30 or 16
    end
end, false)

-- Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ (Ù…Ø²ÙŠÙ†)
task.spawn(function()
    wait(1)
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "âœ¨ Ø§Ù„Ø´Ø§ÙØ·ÙŠÙ† v2.1 âœ¨",
        Text = "ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø¨Ù†Ø¬Ø§Ø­!",
        Duration = 6,
        Icon = "rbxassetid://6722534400"
    })
end)

-- ØªØ£Ø«ÙŠØ±Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
local function createParticles()
    local particles = Instance.new("ParticleEmitter")
    particles.Parent = ToggleButton
    particles.Texture = "rbxassetid://243664672"
    particles.LightEmission = 1
    particles.Size = NumberSequence.new(0.5)
    particles.Transparency = NumberSequence.new(0.5)
    particles.Speed = NumberRange.new(2)
    particles.Lifetime = NumberRange.new(1)
    particles.Rate = 5
    particles.Rotation = NumberRange.new(0, 360)
    particles.SpreadAngle = Vector2.new(360, 360)
    particles.VelocityInheritance = 0.5
    return particles
end

local particles = createParticles()
ToggleButton.MouseEnter:Connect(function()
    particles.Enabled = true
end)
ToggleButton.MouseLeave:Connect(function()
    particles.Enabled = false
end)